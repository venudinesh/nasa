<!doctype html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0" />
    <meta name="description" content="ExoArchive Pocket - Discover and explore exoplanets and space heritage. Browse thousands of confirmed exoplanets with detailed information and timeline of space exploration missions." />
    <meta name="keywords" content="exoplanets, space exploration, NASA, astronomy, planets, timeline, discovery" />
    
    <!-- Preload background image for mobile devices -->
    <link rel="preload" as="image" href="/images/kepler-186f.jpg" media="(max-width: 768px)" />
    
    <!-- Improve performance with resource hints -->
    <link rel="dns-prefetch" href="//api.github.com" />
    <link rel="preconnect" href="//api.github.com" crossorigin />
    <title>ExoArchive Pocket - Discover Exoplanets</title>
  </head>
  <body>
    <!-- Background video (looping). If the browser can't play video, CSS fallback uses /images/blackhole.jpg -->
    <video class="bg-video" autoplay muted loop playsinline aria-hidden="true">
    <!-- model-viewer for lightweight glTF viewing of planets -->
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
      <source src="/images/blackhole.mp4" type="video/mp4" />
      <!-- Fallback text if video element is not supported -->
      Your browser does not support the video tag. The background image will be used instead.
    </video>
  <div class="site-overlay" aria-hidden="true"></div>
  <!-- Fallback user-gesture button: shown when autoplay is blocked so user can start background video -->
  <button id="bg-play-btn" aria-hidden="true" style="display:none">Play background</button>
  <div id="app"></div>
    <script type="module" src="/src/main.tsx"></script>
    <!-- Theme is forced to dark by default to simplify visuals and avoid the theme toggle -->
    <script>
      // Video diagnostics: log load/play/error events for debugging
      (function(){
        const v = document.querySelector('.bg-video');
        if (!v) return;
          function safeLog(...args){ try{ console.log('[BG-VIDEO]',...args); } catch(e){} }
          safeLog('currentSrc', v.currentSrc, 'canPlayType', v.canPlayType('video/mp4'));
          v.addEventListener('loadeddata', ()=> safeLog('loadeddata', v.readyState));
          v.addEventListener('loadedmetadata', ()=> safeLog('loadedmetadata', v.duration, v.videoWidth, v.videoHeight));
          v.addEventListener('play', ()=> safeLog('play'));
          v.addEventListener('playing', ()=> safeLog('playing'));
          v.addEventListener('pause', ()=> safeLog('pause'));
          v.addEventListener('error', (e)=>{ safeLog('error', e); /* keep video hidden handling conservative */ });
          // If the source file is not playable, wait longer before hiding — some networks or setups take longer.
          setTimeout(()=>{
            if (v.readyState === 0) { safeLog('readyState still 0 after timeout — do not hide automatically, check network/codec'); }
          }, 5000);

          // Try programmatic play and log any promise rejection (autoplay policy or other errors)
          const playButton = document.getElementById('bg-play-btn');
          function showPlayButton(){ if (playButton) { playButton.style.display = 'block'; playButton.setAttribute('aria-hidden','false'); }}
          function hidePlayButton(){ if (playButton) { playButton.style.display = 'none'; playButton.setAttribute('aria-hidden','true'); }}

          try {
            const p = v.play();
            if (p && typeof p.then === 'function') {
              p.then(()=> { safeLog('programmatic play() succeeded'); hidePlayButton(); })
               .catch(err => { safeLog('programmatic play() rejected', err); /* show user-gesture */ showPlayButton(); });
            } else {
              safeLog('play() returned no promise (older browser)');
            }
          } catch(err) { safeLog('play() threw', err); showPlayButton(); }

          // If video hasn't loaded/played after a short delay, show play button as fallback
          setTimeout(()=>{
            if (v.readyState === 0 || v.paused) { safeLog('video not ready/paused after timeout — showing play button'); showPlayButton(); }
          }, 2000);

          // Wire up the play button to start the video with a user gesture
          if (playButton) {
            playButton.addEventListener('click', function(){
              try {
                const p = v.play();
                if (p && typeof p.then === 'function') {
                  p.then(()=> { safeLog('user-gesture play succeeded'); hidePlayButton(); })
                   .catch(err => safeLog('user-gesture play rejected', err));
                }
              } catch(err) { safeLog('user-gesture play threw', err); }
            });
          }
          // Audio is managed by the React app (App.tsx) via a controlled <audio> element.
          // The earlier inline autoplay/control logic was removed to avoid duplication.
      })();
    </script>
  </body>
</html>
